<!DOCTYPE html>
<html lang="es">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" charset="utf-8">
  <meta name="author" content="Carlos Pineda Guerrero. 2025">
  <title>Tarea 8 - E-commerce Serverless</title>
  <script src='/api/Get?nombre=/WSClient.js'></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#fafafa; color:#222; }
    .container { width:320px; margin:auto; padding:8px 0 24px 0; }
    h2 { text-align:center; }
    input, select, textarea { width:100%; box-sizing:border-box; padding:8px; margin:4px 0; }
    button { width:100%; height:40px; margin:6px 0; }
    .btn-inline { width:auto; height:auto; padding:6px 10px; margin:4px 6px 0 0; }
    .card { border:1px solid #ddd; background:#fff; border-radius:8px; padding:10px; margin:10px 0; }
    .row { display:flex; gap:8px; align-items:center; }
    .row-col { display:flex; flex-direction:column; gap:6px; }
    .img60 { width:60px; height:60px; object-fit:cover; border-radius:6px; background:#eee; }
    .toolbar { display:flex; gap:8px; flex-wrap:wrap; }
    .muted { color:#666; font-size:0.9em; }
    .success { color:#0a7; }
    .error { color:#c00; }
    .spinner { display:none; text-align:center; margin:8px 0; }
  </style>
  <script>
    var URL = "/api";
    var email;
    var token;
    var id_usuario;

    var foto = null;            // foto de usuario
    var foto_articulo = null;   // foto del artículo en captura

    function get(id){ return document.getElementById(id); }
    function muestra(id){ get(id).style.display = "block"; }
    function oculta(id){ get(id).style.display = "none"; }
    function showSpinner(){ get("spinner").style.display="block"; }
    function hideSpinner(){ get("spinner").style.display="none"; }
    function toast(msg, kind="success"){
      const el = get("toast");
      el.className = kind;
      el.innerText = msg;
      el.style.display = "block";
      setTimeout(()=>{ el.style.display="none"; }, 2500);
    }

    function readSingleFile(files, imagen)
    {
      var file = files[0];
      if (!file) return;
      var reader = new FileReader();
      reader.onload = function(e)
      {
        imagen.src = reader.result;
        var base64 = reader.result.split(',')[1];
        if (imagen.id === "cap_art_imagen")
          foto_articulo = base64;
        else
          foto = base64;
      };
      reader.readAsDataURL(file);
    }

    async function sha256(texto)
    {
      var encoder = new TextEncoder();
      var datos = encoder.encode(texto);
      var hashBuffer = await crypto.subtle.digest('SHA-256', datos);
      var hashArray = Array.from(new Uint8Array(hashBuffer));
      var hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      return hashHex;
    }

    function limpia_login() { get("login_email").value = ""; get("login_password").value = ""; }
    function limpia_alta()
    {
      get("alta_email").value = "";
      get("alta_password").value = "";
      get("alta_nombre").value = "";
      get("alta_apellido_paterno").value = "";
      get("alta_apellido_materno").value = "";
      get("alta_fecha_nacimiento").value = "";
      get("alta_telefono").value = "";
      get("alta_genero").value = "";
      get("alta_imagen").src = "/api/Get?nombre=/usuario_sin_foto.png";
      foto = null;
    }

    function login()
    {
      var cliente = new WSClient(URL);
      if (!get("login_email").value || !get("login_password").value){
        toast("Ingresa email y contraseña", "error"); alert(JSON.stringify({mensaje:"Ingresa email y contraseña"})); return;
      }
      showSpinner();
      sha256(get("login_password").value).then(hash =>
      {
        cliente.get("login",
        { email: get("login_email").value, password: hash },
        function(code,result)
        {
          if (code == 200)
          {
            email = get("login_email").value;
            token = result.token;
            cliente.get("consulta_usuario", { email: email, token: token }, function(c2,res2)
            {
              hideSpinner();
              if (c2==200)
              {
                id_usuario = res2.id_usuario;
                oculta("login"); muestra("menu");
                toast("Bienvenido", "success");
              }
              else { toast(JSON.stringify(res2), "error"); alert(JSON.stringify(res2)); }
            });
          }
          else { hideSpinner(); toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
        });
      });
    }

    function alta()
    {
      var cliente = new WSClient(URL);
      if (!get("alta_email").value || !get("alta_password").value || !get("alta_nombre").value || !get("alta_apellido_paterno").value || !get("alta_fecha_nacimiento").value){
        toast("Completa los campos obligatorios (*)", "error"); alert(JSON.stringify({mensaje:"Completa los campos obligatorios (*)"})); return;
      }
      showSpinner();
      sha256(get("alta_password").value).then(hash =>
      {
        var usuario =
        {
          email: get("alta_email").value,
          password: hash,
          nombre: get("alta_nombre").value,
          apellido_paterno: get("alta_apellido_paterno").value,
          apellido_materno: get("alta_apellido_materno").value != "" ? get("alta_apellido_materno").value : null,
          fecha_nacimiento: get("alta_fecha_nacimiento").value != "" ? new Date(get("alta_fecha_nacimiento").value).toISOString() : null,
          telefono: get("alta_telefono").value != "" ? get("alta_telefono").value : null,
          genero: get("alta_genero").value == "Masculino" ? "M" : get("alta_genero").value == "Femenino" ? "F" : null,
          foto: foto
        };
        cliente.post("alta_usuario", usuario, function(code,result)
        {
          hideSpinner();
          if (code == 200)
          {
            toast("Usuario registrado");
            limpia_login(); oculta('alta_usuario'); muestra('login');
          }
          else { toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
        });
      });
    }

    function limpia_consulta()
    {
      get("consulta_email").value = "";
      get("consulta_password").value = "";
      get("consulta_nombre").value = "";
      get("consulta_apellido_paterno").value = "";
      get("consulta_apellido_materno").value = "";
      get("consulta_fecha_nacimiento").value = "";
      get("consulta_telefono").value = "";
      get("consulta_genero").value = "";
      get("consulta_imagen").src = "/api/Get?nombre=/usuario_sin_foto.png";
    }

    function quita_foto()
    {
      foto=null;
      get("consulta_imagen").src = "/api/Get?nombre=/usuario_sin_foto.png";
      get('consulta_file').value='';
    }

    function formatearFecha(fecha)
    {
      var fecha = new Date(fecha);
      var año = fecha.getFullYear();
      var mes = (fecha.getMonth() + 1).toString().padStart(2,'0');
      var dia = fecha.getDate().toString().padStart(2,'0');
      var horas = fecha.getHours().toString().padStart(2,'0');
      var minutos = fecha.getMinutes().toString().padStart(2,'0');
      var segundos = fecha.getSeconds().toString().padStart(2,'0');
      return año + "-" + mes + "-" + dia + "T" + horas + ":" + minutos + ":" + segundos;
    }

    function consulta()
    {
      var cliente = new WSClient(URL);
      showSpinner();
      cliente.get("consulta_usuario", { email: email, token: token }, function(code,result)
      {
        hideSpinner();
        if (code == 200)
        {
          limpia_consulta(); oculta('menu'); muestra('consulta_usuario');
          get("consulta_email").value = result.email;
          get("consulta_password").value = "";
          get("consulta_nombre").value = result.nombre;
          get("consulta_apellido_paterno").value = result.apellido_paterno;
          get("consulta_apellido_materno").value = result.apellido_materno != null ? result.apellido_materno : "";
          get("consulta_fecha_nacimiento").value = formatearFecha(new Date(result.fecha_nacimiento+"Z").toLocaleString('en-US'));
          get("consulta_telefono").value = result.telefono != null ? result.telefono : "";
          get("consulta_genero").value = result.genero == "M" ? "Masculino" : result.genero == "F" ? "Femenino" : "";
          foto = result.foto; id_usuario = result.id_usuario;
          get("consulta_imagen").src = foto != null ? "data:image/jpeg;base64," + foto : "/api/Get?nombre=/usuario_sin_foto.png";
        }
        else { toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
      });
    }

    function modifica_usuario(password)
    {
      var cliente = new WSClient(URL);
      var usuario =
      {
        password: password,
        nombre: get("consulta_nombre").value,
        apellido_paterno: get("consulta_apellido_paterno").value,
        apellido_materno: get("consulta_apellido_materno").value != "" ? get("consulta_apellido_materno").value : null,
        fecha_nacimiento: get("consulta_fecha_nacimiento").value != "" ? new Date(get("consulta_fecha_nacimiento").value).toISOString() : null,
        telefono: get("consulta_telefono").value != "" ? get("consulta_telefono").value : null,
        genero: get("consulta_genero").value == "Masculino" ? "M" : get("consulta_genero").value == "Femenino" ? "F" : null,
        foto: foto
      };
      showSpinner();
      cliente.put("modifica_usuario", { email: get("consulta_email").value, token: token }, usuario, function(code,result)
      {
        hideSpinner();
        if (code == 200) { toast("Perfil actualizado"); }
        else { toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
      });
    }
    function modifica()
    {
      if (get("consulta_password").value != "")
        sha256(get("consulta_password").value).then(hash => { modifica_usuario(hash); });
      else modifica_usuario("");
    }
    function borra()
    {
      var client = new WSClient(URL);
      if (!confirm('¿Deseas eliminar el perfil del usuario?')) return;
      showSpinner();
      client.delete("borra_usuario", { email: email, token: token }, function(code,result)
      {
        hideSpinner();
        if (code == 200)
        {
          toast("Perfil eliminado"); limpia_login(); oculta('menu'); muestra('login');
        }
        else { toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
      });
    }

    // -------------------- E-COMMERCE FRONT-END --------------------

    // Captura de artículo
    function limpia_captura_articulo()
    {
      get("cap_art_nombre").value = "";
      get("cap_art_descripcion").value = "";
      get("cap_art_precio").value = "";
      get("cap_art_cantidad").value = "";
      get("cap_art_imagen").src = "/api/Get?nombre=/usuario_sin_foto.png";
      foto_articulo = null;
    }
    function ir_captura_articulo(){ limpia_captura_articulo(); oculta('menu'); muestra('captura_articulo'); }
    function alta_articulo()
    {
      var nombre = get("cap_art_nombre").value.trim();
      var descripcion = get("cap_art_descripcion").value.trim();
      var precio = parseFloat(get("cap_art_precio").value);
      var cantidad = parseInt(get("cap_art_cantidad").value);
      if (!nombre || !descripcion || isNaN(precio) || isNaN(cantidad) || precio<=0 || cantidad<0){
        toast("Verifica nombre, descripción, precio (>0) y cantidad (>=0)", "error"); alert(JSON.stringify({mensaje:"Verifica nombre, descripción, precio (>0) y cantidad (>=0)"})); return;
      }
      var cliente = new WSClient(URL);
      showSpinner();
      var body = { nombre, descripcion, precio, cantidad, foto: foto_articulo, id_usuario, token };
      cliente.post("alta_articulo", body, function(code,result){
        hideSpinner();
        if (code==200){ toast("Artículo registrado"); oculta('captura_articulo'); muestra('menu'); }
        else { toast(JSON.stringify(result), "error"); alert(JSON.stringify(result)); }
      });
    }

    // Compra de artículos: ahora solo "Agregar al carrito"
    var resultados = [];
    function ir_compra_articulos(){ get("compra_busqueda").value = ""; get("resultados").innerHTML = ""; oculta('menu'); muestra('compra_articulos'); }
    function buscar_articulos()
    {
      var palabra = get("compra_busqueda").value.trim();
      var cliente = new WSClient(URL);
      showSpinner();
      cliente.get("consulta_articulos", { palabra_clave: palabra, id_usuario, token }, function(code,res)
      {
        hideSpinner();
        if (code==200){ resultados = res; render_resultados(); }
        else { toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }
    function render_resultados()
    {
      var cont = get("resultados"); cont.innerHTML = "";
      if (!resultados || resultados.length===0){ cont.innerHTML = "<div class='muted'>Sin resultados</div>"; return; }
      resultados.forEach(a =>
      {
        var card = document.createElement("div"); card.className="card";
        var row = document.createElement("div"); row.className="row";
        var img = document.createElement("img"); img.className="img60"; img.alt="Foto"; img.src = a.foto ? ("data:image/jpeg;base64,"+a.foto) : "/api/Get?nombre=/usuario_sin_foto.png";
        var info = document.createElement("div"); info.className="row-col";
        var nombre = document.createElement("strong"); nombre.innerText = a.nombre;
        var des = document.createElement("div"); des.className="muted"; des.innerText = a.descripcion;
        var precio = document.createElement("div"); precio.innerText = "Precio: $" + a.precio;
        var qtyRow = document.createElement("div"); qtyRow.className="row"; qtyRow.style.justifyContent="space-between";
        var qtyLabel = document.createElement("span"); qtyLabel.innerText = "Cantidad: ";
        var qty = document.createElement("input"); qty.type="number"; qty.min="1"; qty.value="1"; qty.style.width="80px"; qty.id="qty_"+a.id_articulo;
        var btnAdd = document.createElement("button"); btnAdd.className="btn-inline"; btnAdd.innerText="Agregar al carrito";
        btnAdd.onclick = function(){
          var cantidad = parseInt(qty.value);
          if (isNaN(cantidad) || cantidad<=0){ toast("Cantidad inválida", "error"); alert(JSON.stringify({mensaje:"Cantidad inválida"})); return; }
          compra_articulo(a.id_articulo, cantidad); // usa back-end de compra (añade al carrito y descuenta stock)
        };
        info.appendChild(nombre); info.appendChild(des); info.appendChild(precio);
        qtyRow.appendChild(qtyLabel); qtyRow.appendChild(qty); qtyRow.appendChild(btnAdd);
        info.appendChild(qtyRow);
        row.appendChild(img); row.appendChild(info);
        card.appendChild(row);
        cont.appendChild(card);
      });
    }
    function compra_articulo(id_articulo, cantidad)
    {
      var cliente = new WSClient(URL);
      showSpinner();
      var body = { id_articulo, cantidad, id_usuario, token };
      cliente.post("compra_articulo", body, function(code,res)
      {
        hideSpinner();
        if (code==200) { toast("Agregado al carrito"); }
        else { toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }

    // Carrito: tiene +, -, Eliminar, Total, Comprar todo y Eliminar carrito
    var carritoItems = [];
    function ir_carrito(){ cargar_carrito(); oculta('compra_articulos'); muestra('carrito'); }
    function cargar_carrito()
    {
      var cliente = new WSClient(URL);
      showSpinner();
      cliente.get("consulta_carrito", { id_usuario, token }, function(code,res)
      {
        hideSpinner();
        if (code==200){ carritoItems = res; render_carrito(); }
        else { get("carrito_contenido").innerHTML = ""; toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }
    function render_carrito()
    {
      var cont = get("carrito_contenido"); cont.innerHTML="";
      var total = 0;
      if (!carritoItems || carritoItems.length===0){
        cont.innerHTML = "<div class='muted'>Tu carrito está vacío</div>";
        get("carrito_total").innerText = "Total: $0.00"; return;
      }
      carritoItems.forEach(x =>
      {
        var card = document.createElement("div"); card.className="card";
        var row = document.createElement("div"); row.className="row";
        var img = document.createElement("img"); img.className="img60"; img.alt="Foto"; img.src = x.foto ? ("data:image/jpeg;base64,"+x.foto) : "/api/Get?nombre=/usuario_sin_foto.png";
        var info = document.createElement("div"); info.className="row-col";
        var nombre = document.createElement("strong"); nombre.innerText = x.nombre;
        var detalle = document.createElement("div"); detalle.innerText = "Cantidad: " + x.cantidad + "  •  Precio: $" + x.precio.toFixed(2);
        var costo = x.cantidad * x.precio; total += costo;
        var costoDiv = document.createElement("div"); costoDiv.innerText = "Costo: $" + costo.toFixed(2);
        var actions = document.createElement("div"); actions.className="toolbar";
        var btnPlus = document.createElement("button"); btnPlus.className="btn-inline"; btnPlus.innerText = "+";
        btnPlus.onclick = function(){ modifica_carrito(x.id_articulo, +1); };
        var btnMinus = document.createElement("button"); btnMinus.className="btn-inline"; btnMinus.innerText = "-";
        btnMinus.onclick = function(){ modifica_carrito(x.id_articulo, -1); };
        var btnEliminar = document.createElement("button"); btnEliminar.className="btn-inline"; btnEliminar.innerText = "Eliminar artículo";
        btnEliminar.onclick = function(){ eliminar_articulo_carrito(x.id_articulo); };
        actions.appendChild(btnPlus); actions.appendChild(btnMinus); actions.appendChild(btnEliminar);

        info.appendChild(nombre); info.appendChild(detalle); info.appendChild(costoDiv); info.appendChild(actions);
        row.appendChild(img); row.appendChild(info);
        card.appendChild(row);
        cont.appendChild(card);
      });
      get("carrito_total").innerText = "Total: $" + total.toFixed(2);
    }
    function modificar_y_recargar(incremento, id_articulo)
    {
      var cliente = new WSClient(URL);
      showSpinner();
      var body = { id_articulo, incremento, id_usuario, token };
      cliente.put("modifica_carrito_compra", {}, body, function(code,res)
      {
        hideSpinner();
        if (code==200){ cargar_carrito(); }
        else { toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }
    function modifica_carrito(id_articulo, incremento){ modificar_y_recargar(incremento, id_articulo); }
    function eliminar_articulo_carrito(id_articulo)
    {
      var cliente = new WSClient(URL);
      showSpinner();
      cliente.delete("elimina_articulo_carrito_compra", { id_usuario, id_articulo, token }, function(code,res)
      {
        hideSpinner();
        if (code==200){ toast("Artículo eliminado"); cargar_carrito(); }
        else { toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }
    function eliminar_carrito()
    {
      if (!confirm("¿Eliminar todo el carrito?")) return;
      var cliente = new WSClient(URL);
      showSpinner();
      cliente.delete("elimina_carrito_compra", { id_usuario, token }, function(code,res)
      {
        hideSpinner();
        if (code==200){ toast("Carrito eliminado"); cargar_carrito(); }
        else { toast(JSON.stringify(res), "error"); alert(JSON.stringify(res)); }
      });
    }
    function comprar_todo()
    {
      // POST finaliza_compra con id_usuario y token via query
      showSpinner();
      fetch(URL + "/finaliza_compra?id_usuario=" + encodeURIComponent(id_usuario) + "&token=" + encodeURIComponent(token),
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: "{}"
      })
      .then(respuesta => respuesta.json().then(data =>
      {
        hideSpinner();
        if (respuesta.status == 200)
        {
          toast("Compra realizada. Orden #" + data.id_orden + " • Total $" + Number(data.total).toFixed(2));
          cargar_carrito();
        }
        else { toast(JSON.stringify(data), "error"); alert(JSON.stringify(data)); }
      }))
      .catch(error => { hideSpinner(); toast("Error: " + error.message, "error"); alert(JSON.stringify({mensaje:error.message})); });
    }
    function seguir_comprando(){ oculta('carrito'); muestra('compra_articulos'); }

  </script>
</head>
<body>
  <div class="container">
    <h2>Tarea 8 - Sistema de comercio electrónico</h2>
    <div id="spinner" class="spinner">Cargando...</div>
    <div id="toast" class="muted" style="display:none"></div>

    <!-- Alta usuario -->
    <div id="alta_usuario" style="display:none">
      <h2>Registro de usuario</h2>
      Email *<input type="email" id="alta_email"/><br>
      Contraseña *<input type="password" id="alta_password"/><br>
      Nombre *<input type="text" id="alta_nombre"/><br>
      Apellido paterno *<input type="text" id="alta_apellido_paterno"/><br>
      Apellido materno<input type="text" id="alta_apellido_materno"/><br>
      Fecha de nacimiento *<input type="datetime-local" id="alta_fecha_nacimiento"/><br>
      Teléfono<input type="number" id="alta_telefono"/><br>
      Género<select id="alta_genero"><option></option><option>Masculino</option><option>Femenino</option></select><br><br>
      <img id="alta_imagen" class="img60" src="/api/Get?nombre=/usuario_sin_foto.png" alt="Foto de usuario"><br>
      <input type="file" onchange="readSingleFile(files,get('alta_imagen'))" multiple="false" accept="image/*"/><br><br>
      <button type="button" onclick="alta()">Registrar usuario</button>
      <button type="button" onclick="limpia_login();oculta('alta_usuario');muestra('login')">Cancelar</button>
    </div>

    <!-- Consulta/modifica usuario -->
    <div id="consulta_usuario" style="display:none">
      <h2>Perfil del usuario</h2>
      Email *<input type="email" readonly id="consulta_email" placeholder="ingresar una nueva contraseña"/><br>
      Contraseña *<input type="password" id="consulta_password"/><br>
      Nombre *<input type="text" id="consulta_nombre"/><br>
      Apellido paterno *<input type="text" id="consulta_apellido_paterno"/><br>
      Apellido materno<input type="text" id="consulta_apellido_materno"/><br>
      Fecha de nacimiento *<input type="datetime-local" id="consulta_fecha_nacimiento"/><br>
      Teléfono<input type="number" id="consulta_telefono"/><br>
      Género<select id="consulta_genero"><option></option><option>Masculino</option><option>Femenino</option></select><br><br>
      <img id="consulta_imagen" class="img60" src="/api/Get?nombre=/usuario_sin_foto.png" alt="Foto de usuario"><br>
      <input type="file" id="consulta_file" onchange="readSingleFile(files,get('consulta_imagen'))" multiple="false" accept="image/*"/><br>
      <button class="btn-inline" onclick="quita_foto()">Quitar foto</button><br><br>
      <button type="button" onclick="modifica()">Guardar cambios</button>
      <button type="button" onclick="oculta('consulta_usuario');muestra('menu')">Regresar</button>
    </div>

    <!-- Menú principal -->
    <div id="menu" style="display:none">
      <button type="button" onclick="consulta()">Perfil del usuario</button>
      <button type="button" onclick="ir_captura_articulo()">Captura de artículo</button>
      <button type="button" onclick="ir_compra_articulos()">Compra de artículos</button>
      <button type="button" onclick="borra()">Eliminar perfil</button>
      <button type="button" onclick="limpia_login();oculta('menu');muestra('login')">Salir</button>
    </div>

    <!-- Captura de artículo -->
    <div id="captura_articulo" style="display:none">
      <h2>Captura de artículo</h2>
      Nombre *<input type="text" id="cap_art_nombre"/>
      Descripción *<textarea id="cap_art_descripcion" rows="3"></textarea>
      Precio *<input type="number" id="cap_art_precio" step="0.01"/>
      Cantidad *<input type="number" id="cap_art_cantidad"/>
      Fotografía<br>
      <img id="cap_art_imagen" class="img60" src="/api/Get?nombre=/usuario_sin_foto.png" alt="Foto del artículo"><br>
      <input type="file" onchange="readSingleFile(files,get('cap_art_imagen'))" multiple="false" accept="image/*"/><br><br>
      <button type="button" onclick="alta_articulo()">Guardar</button>
      <button type="button" onclick="oculta('captura_articulo');muestra('menu')">Regresar</button>
    </div>

    <!-- Compra de artículos -->
    <div id="compra_articulos" style="display:none">
      <h2>Compra de artículos</h2>
      Palabra clave<input type="text" id="compra_busqueda"/>
      <button type="button" onclick="buscar_articulos()">Buscar</button>
      <div id="resultados"></div>
      <button type="button" onclick="ir_carrito()">Carrito de compra</button>
      <button type="button" onclick="oculta('compra_articulos');muestra('menu')">Regresar</button>
    </div>

    <!-- Carrito -->
    <div id="carrito" style="display:none">
      <h2>Artículos en el carrito</h2>
      <div id="carrito_contenido"></div>
      <div id="carrito_total" style="font-weight:bold; margin-top:8px;">Total: $0.00</div><br>
      <button type="button" onclick="comprar_todo()">Comprar todo</button>
      <button type="button" onclick="eliminar_carrito()">Eliminar carrito</button>
      <button type="button" onclick="seguir_comprando()">Seguir comprando</button>
      <button type="button" onclick="oculta('carrito');muestra('menu')">Regresar</button>
    </div>

    <!-- Login -->
    <div id="login">
      <h2>Acceso al sistema</h2>
      Email<input type="email" id="login_email"/>
      Password<input type="password" id="login_password"/>
      <button type="button" onclick="login()">Aceptar</button>
      <button type="button" onclick="limpia_alta();oculta('login');muestra('alta_usuario')">Registro de usuario</button>
    </div>
  </div>
</body>
</html>